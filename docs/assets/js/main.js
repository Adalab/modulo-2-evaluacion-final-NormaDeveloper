"use strict";console.log(">> Ready :)");const searchBtn=document.querySelector(".js_searchBtn"),resultsList=document.querySelector(".js-resultsList"),inputField=document.querySelector(".js_searchInput"),favList=document.querySelector(".js-favList"),resetBtn=document.querySelector(".js_reset"),PLACEHOLDER_URL="https://via.placeholder.com/225x317ffffff/666666/?text=ANIME";let moviesData=[],favMoviesData=[];function conectToApi(){let e=inputField.value.toLowerCase();e.length>=3&&fetch(`https://api.jikan.moe/v3/search/anime?q=${e}&limit=9`).then(e=>e.json()).then(e=>{moviesData=e.results,moviesData.sort((function(e,t){return e.title>t.title?1:e.title<t.title?-1:0})),renderAllMovies()}).catch(e=>console.log("Ha sucedido un error: "+e))}function handleSearchBtn(e){e.preventDefault(),conectToApi()}function renderAllMovies(){resultsList.textContent="";document.querySelector(".js_resultsTitle").classList.remove("hidden");for(const e of moviesData){console.log(e.title);let t="";t=void 0===favMoviesData.find(t=>t.mal_id===e.mal_id)?"":"fav",e.image_url?resultsList.innerHTML+=`<li class="section__results--list--li js_img ${t}" data-id=${e.mal_id}>\n  <img class="section__results--list--li--img " src=" ${e.image_url}" alt="" />\n  <h3 class="section__results--list--li--title ">${e.title}</h3>\n  </li>`:(e.image_url=e.image_url.replace(e.image_url,PLACEHOLDER_URL),resultsList.innerHTML+=`<li class="section__results--list--li js_img ${t}" data-id=${e.mal_id}>\n  <img class="section__results--list--li--img " src=" ${e.image_url}" alt="" />\n  <h3 class="section__results--list--li--title">${e.title}</h3>\n  </li>`)}addListenersToMovies()}function addListenersToMovies(){const e=document.querySelectorAll(".js_img");for(const t of e)t.addEventListener("click",handleClickImg)}function handleClickImg(e){const t=parseInt(e.currentTarget.dataset.id),s=moviesData.find(e=>e.mal_id===t);console.log(s);void 0===favMoviesData.find(e=>e.mal_id===t)?favMoviesData.push(s):favMoviesData=favMoviesData.filter(e=>e.mal_id!==t),setFavMoviesInLocalStorage(),renderFavMovies(),renderAllMovies()}function renderFavMovies(){favList.innerHTML="";for(const e of favMoviesData)favList.innerHTML+=`<li data-id=${e.mal_id} class=" section__fav--list-favorite--li   " >\n      <img class="section__results--list--li--img favImg" src="${e.image_url}" alt="" />\n      <h3 class="section__results--list--li--title favTitle" >${e.title}</h3>\n      <button class="section__results--list--li--delete delete-btn js_deleteBtn" title="Delete movie" data-id= "${e.mal_id}" >x</button>\n      </li>`;addListenerToDeleteBtn()}function setFavMoviesInLocalStorage(){localStorage.setItem("fav_movies",JSON.stringify(favMoviesData))}function getFavMoviesFromLocalStorage(){const e=localStorage.getItem("fav_movies");null===e?favMoviesData=[]:(favMoviesData=JSON.parse(e),renderFavMovies())}function addListenerToDeleteBtn(){const e=document.querySelectorAll(".js_deleteBtn");for(const t of e)t.addEventListener("click",handleClickImg)}function handleReset(){favMoviesData=[],localStorage.clear(),location.reload()}searchBtn.addEventListener("click",handleSearchBtn),getFavMoviesFromLocalStorage(),resetBtn.addEventListener("click",handleReset);